<!doctype html>
<html>
  <head>
    
    <!-- -->
    <script type="text/javascript" src="assets/dev/hnl.mobileConsole.js"></script>
    <!-- -->
    
    <title>La Cuentita</title>
		<!-- https://github.com/almendro/lacuentita -->

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <link rel="stylesheet" type="text/css" href="css/styles.css" media="screen" />

    <script src="assets/modernizr.js"></script>

    <script>
      
      /*
				Consola alternativa para desarrollo en tablet
      */
      var $consola, $bitacora, trace;
      trace=function(e){
        var cl = (console.log);
       // cl=false;
        if (cl){
          console.log(e);
        } else { 
          alert(e);  
        }
      };
      
      var tools;
      var app = "lacuentita";
      var app_partes = {
        total: 0,
        actual: 0,
        completo: null // function
      };
      var aplicacion;
      
      Modernizr.load([
        {
          load: "assets/jquery-2.2.3.min.js",
          complete: function (){
            if(!window.jQuery){
              trace("fallo jQuery");
            }
          }
        },
        "assets/moment.min.js",
        "assets/js.storage.min.js",
        "assets/jquery.serializejson.min.js",
        "assets/populateform.js",
        "assets/varios.js",
    	"assets/doblekey.js",
        "assets/megagui.js",        
        "js/ui.js",
        "js/io.js",
        {
          load: "js/"+app+".js",
          complete: lanzar
        } /* load app */
      ]); /* /Modernizr.load */
      
      function load_partes(p,callback){
        trace("load_partes "+p);
        p = listar(p);
        app_partes.total = contar(p);
        app_partes.actual = 0;
        app_partes.completo = callback;
        for (i in p) {
          app_partes.actual++;
          trace("partes: "+p+" "+(Number(i)+1)+"/"+app_partes.total);
          $("head").append('<link rel="stylesheet" type="text/css" href="css/'+p[i]+'.css" media="screen" /> ');
          $("#secciones").append('<div id="'+p[i]+'"></div>');
          $("#"+p[i]).load(p[i]+".html",function( response, status, xhr ) {
            if ( status == "error" ) {
            var msg = "Sorry but there was an error: ";
              trace( msg + xhr.status + " " + xhr.statusText );
            }
            if (app_partes.actual==app_partes.total) app_partes.completo();
          });
        }
      }
      function lanzar (){
        trace("lanzar");
        /* esto es necesario que este aca asi se carga si o si */
        if(!window[app]){
          trace("fallo "+app);
        } else {
        /*
          trace("preparar bitácora");
          $bitacora = $("#consola #log");
          $consola = $("#consola");
          $consola_fondo = $("#consola_fondo");
          $consola_btn = $("#consola_btn");
          trace = function (e){
            $bitacora.append("<li>"+e+"</li>");
          }
          $consola_btn.bind("click",function(){
            $consola.toggleClass("abierta");
            if($consola.hasClass("abierta")){
              $consola_fondo.show();
              $consola_fondo.bind("click", function(){
                $consola_btn.click();
              });
            } else {
              $consola_fondo.hide();
              $consola_fondo.unbind("click");
            }
          });
         
          $("#clearAllNiceAlert").click(function(){
            $("#nice_alert").toggle();
          });
          
          /* ------------------------------------ */
          
          trace("cargó con éxito "+app+".js");
          trace("");
          trace("... INICIAR ...");
          /* */
          tools = new window.megagui.tools();
          tools.iniciar();
          
          tools.doblekey.estalecer_tecla({
            tecla: 27,
            funcion: function(){
              trace("ESCAPE!!!");
              $("#clearAllNiceAlert").click();
            }
          });
          tools.doblekey.estalecer_tecla({
            tecla: 84,
            funcion: function(){
              trace("TERMINAL!!!");
              $consola_btn.click();
            }
          });
          
          /* */
          trace("preparar partes");
          load_partes([
          "mi_cabecera",
          "bienvenida",
          "mis_inicios"
          ],
          dale_gas
          );
        }
      } // lanzar
      function dale_gas(){
        $('.menu-toggle').click(function() {
      
          $('ul').toggleClass('opening');
          $(this).toggleClass('open');
      
        });
        $("#consola").hide();
        aplicacion = new window[app].aplicacion();
        //aplicacion.iniciar();
      }
    </script>

    <!-- -->
    <link rel="stylesheet" type="text/css" media="screen" href="assets/nicealert/style.css" />
    <script src="assets/nicealert/nice_alert.js"></script>
    <!-- -->

  </head>

  <body>
  <!-- ------------------ -->

    <header id="mi_cabecera">
    </header><!-- /#mi_cabecera -->

  <!-- ------------------ -->
    <div id="secciones"></div>
  <!-- ------------------ -->
 
    <footer>
      <!-- navegación -->
      <nav id="menu_accion" class="barra_acciones barra">
        <ul>
          <li>
            <a id="m_accionRapida" 
              class="" 
              href="#accionRapida" >
              <span>Acción rápida</span>
            </a>
          </li>
        </ul>
      </nav>
    </footer>
    
  <!-- ------------------ -->
  
    <div id="dialogos_div" class="fondo fondo_completo"></div>
    
    <div id="dialogo_confirmar" 
         data-plantilla-id="dialogo_confirmar" 
         class="plantilla_html dialogo" >
      <header>
        <h1>Confirmar</h1>
      </header>
      <div class="contenido">
				<div class="mensaje">
          (mensaje)
        </div><!-- mensaje -->
        <button class="dialogo_no" >NO</button>
        <button class="dialogo_si" >SI</button>
      </div><!-- .contenido -->
    </div><!-- #dialogo_confirmar -->


  <!-- ------------------ -->

    <!-- /* DEV */ -->
        
    <div id="consola_fondo" class="fondo fondo_completo"></div>
    <div id="consola">
      <header class="cabecera">
        <button id="consola_btn" class="btn btn-fab"><span>>CONSOLA</span></button>
        <h3>CONSOLA</h3>
      </header>
      <ol id="log">
      </ol><!-- /#log -->
    </div><!-- /#consola -->
    
    
    <div id="clearAllNiceAlert" class="btn btn-raised btn-danger btn-xs">
			Toggle All NiceAlerts
    </div>
    <!-- -->

  </body>
</html>