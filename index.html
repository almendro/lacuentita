<!doctype html>
<html>
  <head>
    
    <!-- -->
    <script type="text/javascript" src="assets/dev/hnl.mobileConsole.js"></script>
    <!-- -->
    
    <title>La Cuentita</title>
		<!-- https://github.com/almendro/lacuentita -->

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <link rel="stylesheet" type="text/css" href="css/styles.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="assets/bootstrap.css" media="screen" />

    <script src="assets/modernizr.js"></script>

    <script>
      
      /*
				Consola alternativa para desarrollo en tablet
      */
      var $consola, $bitacora, trace;
      trace=function(e){
        var cl = (console.log);
       // cl=false;
        if (cl){
          console.log(e);
        } else { 
          alert(e);  
        }
      };
      
      var tools;
      var app = {
				nombre: "La Cuentita",
				slug: "lacuentita",
				partes: {
					total: 0,
					actual: 0,
					completo: null // function
				},
				aplicacion: false
      }; // var app
      
      Modernizr.load([
        {
          load: "assets/jquery-2.2.3.min.js",
          complete: function (){
            if(!window.jQuery){
              trace("fallo jQuery");
            }
          }
        },
        "assets/moment.min.js",
        "assets/js.storage.min.js",
        "assets/jsonform.js",
        "assets/jsv.js",
        "assets/underscore.js",
        "assets/varios.js",
				"assets/doblekey.js",
        "assets/megagui.js",        
        "js/ui.js",
        "js/io.js",
        {
          load: "js/"+app.slug+".js",
          complete: lanzar
        } /* load app */
      ]); /* /Modernizr.load */
      
      function load_partes(p,callback){
        trace("load_partes "+p);
        p = listar(p);
        app.partes.total = contar(p);
        app.partes.actual = 0;
        app.partes.completo = callback;
        for (i in p) {
          trace("partes: "+p[i]+" "+(Number(i)+1)+"/"+app.partes.total);
          $("head").append('<link rel="stylesheet" type="text/css" href="css/'+p[i]+'.css" media="screen" /> ');
          var tmp = p[i].split("_");
          if ( tmp[0]=="mis" ) $("#secciones").append('<div id="'+p[i]+'"></div>');
          $("#"+p[i]).load(p[i]+".html",function( response, status, xhr ) {
            if ( status == "error" ) {
            var msg = "Sorry but there was an error: ";
              trace( msg + xhr.status + " " + xhr.statusText );
            } else {
							app.partes.actual++;
							trace("if "+app.partes.actual+"=="+app.partes.total);
							if (app.partes.actual==app.partes.total) app.partes.completo();
						}
          });
        }
      }
      function lanzar (){
        trace("lanzar");
        /* esto es necesario que este aca asi se carga si o si */
        if(!window[app.slug]){
          trace("fallo "+app.slug+".js");
        } else {
        
          trace("preparar bitácora");
          $bitacora = $("#consola #log");
          $consola = $("#consola");
          $consola_fondo = $("#consola_fondo");
          $consola_btn = $("#consola_btn");
          trace = function (e){
            $bitacora.append("<li>"+e+"</li>");
            console.log(e);
          }
          $consola_btn.bind("click",function(){
            $consola.toggleClass("abierta");
            if($consola.hasClass("abierta")){
              $consola_fondo.show();
              $consola_fondo.bind("click", function(){
                $consola_btn.click();
              });
            } else {
              $consola_fondo.hide();
              $consola_fondo.unbind("click");
            }
          });
         
          $("#clearAllNiceAlert").click(function(){
            $("#nice_alert").toggle();
          });
          
          /* ------------------------------------ */
          
          trace("cargó con éxito "+app.slug+".js");
          trace("");
          trace("... INICIAR ...");
          /* */
          tools = new window.megagui.tools();
          tools.iniciar();
          
          tools.doblekey.estalecer_tecla({
            tecla: 27,
            funcion: function(){
              trace("ESCAPE!!!");
              $("#clearAllNiceAlert").click();
            }
          });
          tools.doblekey.estalecer_tecla({
            tecla: 84,
            funcion: function(){
              trace("TERMINAL!!!");
              $consola_btn.click();
            }
          });
          
          /* */
          trace("preparar partes");
          load_partes([
          "mi_cabecera",
          "mis_bienvenida",
          "mis_inicios",
          "mis_cuentitas",
          "mis_productos",
          "mis_comercios",
          "mis_perfiles",
          "mis_configuraciones",
          "mis_acerca_de"
          ],
          dale_gas
          );
        }
      } // lanzar
      function dale_gas(){
        app.aplicacion = new window[app.slug].aplicacion();
        app.aplicacion.iniciar();
      }
    </script>

    <!-- -->
    <link rel="stylesheet" type="text/css" media="screen" href="assets/nicealert/style.css" />
    <script src="assets/nicealert/nice_alert.js"></script>
    <!-- -->

  </head>

  <body>
  <!-- ------------------ -->

    <header id="mi_cabecera">
    </header><!-- /#mi_cabecera -->

  <!-- ------------------ -->
    <div id="secciones"></div>
  <!-- ------------------ -->
 
    <footer>
      <!-- navegación -->
      <nav id="menu_accion" class="barra_acciones barra">
        <ul>
          <li>
            <a id="m_accionRapida" 
              class="" 
              href="#accionRapida" >
              <span>Acción rápida</span>
            </a>
          </li>
        </ul>
      </nav>
    </footer>
    


  <!-- ------------------ -->

    <!-- /* DEV */ -->
        
    <div id="consola_fondo" class="fondo fondo_completo"></div>
    <div id="consola">
      <header class="cabecera">
        <button id="consola_btn" class="btn btn-fab"><span>>CONSOLA</span></button>
				<div id="clearAllNiceAlert" class="btn btn-raised btn-danger btn-xs">
					Toggle All NiceAlerts
				</div>
        <h3>CONSOLA</h3>
      </header>
      <ol id="log">
      </ol><!-- /#log -->
    </div><!-- /#consola -->
    
    

    <!-- -->

  </body>
</html>
